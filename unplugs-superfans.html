<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unplugs Superfan Influencer Database</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 20px;
        }
        .container { max-width: 1600px; margin: 0 auto; }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
        }
        h1 { 
            font-size: 2.5rem;
            background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3, #54a0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .subtitle { color: #888; font-size: 1.1rem; }
        
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .stat {
            text-align: center;
            padding: 15px 25px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .stat-value { font-size: 2rem; font-weight: bold; color: #fff; }
        .stat-label { font-size: 0.85rem; color: #888; margin-top: 5px; }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .filter-group { display: flex; flex-direction: column; gap: 5px; }
        .filter-group label { font-size: 0.8rem; color: #888; text-transform: uppercase; }
        select, input[type="text"] {
            padding: 10px 15px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 0.95rem;
            min-width: 150px;
        }
        select:focus, input:focus { outline: none; border-color: #54a0ff; }
        
        .genre-pills {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .genre-pill {
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .genre-pill:hover { transform: scale(1.05); }
        .genre-pill.active { border-color: #fff; }
        .genre-pill.all { background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb); color: #000; }
        .genre-pill.electronic { background: #9b59b6; }
        .genre-pill.rock { background: #e74c3c; }
        .genre-pill.indie { background: #3498db; }
        .genre-pill.metal { background: #2c3e50; }
        .genre-pill.funk { background: #f39c12; color: #000; }
        
        .table-container {
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        table { width: 100%; border-collapse: collapse; }
        th {
            background: rgba(255,255,255,0.1);
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #aaa;
            cursor: pointer;
            position: sticky;
            top: 0;
        }
        th:hover { background: rgba(255,255,255,0.15); }
        td {
            padding: 14px 12px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 0.9rem;
        }
        tr:hover { background: rgba(255,255,255,0.05); }
        
        .genre-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .genre-badge.electronic { background: #9b59b6; }
        .genre-badge.rock { background: #e74c3c; }
        .genre-badge.indie { background: #3498db; }
        .genre-badge.metal { background: #2c3e50; }
        .genre-badge.funk { background: #f39c12; color: #000; }
        
        .handle-cell a {
            color: #54a0ff;
            text-decoration: none;
            font-weight: 500;
        }
        .handle-cell a:hover { text-decoration: underline; }
        
        .followers { font-weight: 600; color: #feca57; }
        .engagement { color: #2ecc71; }
        
        .positioning { 
            max-width: 300px; 
            font-size: 0.85rem;
            color: #aaa;
            line-height: 1.4;
        }
        .fit { 
            max-width: 250px;
            font-size: 0.85rem;
            color: #888;
        }
        
        .export-btn {
            background: linear-gradient(90deg, #54a0ff, #5f27cd);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .export-btn:hover { transform: scale(1.05); }
        
        .no-results {
            text-align: center;
            padding: 50px;
            color: #888;
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .stats-bar { gap: 15px; }
            .stat { padding: 10px 15px; }
            .positioning, .fit { max-width: 200px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ§ Unplugs Superfan Database</h1>
            <p class="subtitle">Music influencers who are FANS, not performers â€” ready for hearing protection partnerships</p>
        </header>
        
        <div class="stats-bar">
            <div class="stat">
                <div class="stat-value" id="totalCount">250</div>
                <div class="stat-label">Total Profiles</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="filteredCount">250</div>
                <div class="stat-label">Showing</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="totalReach">-</div>
                <div class="stat-label">Combined Reach</div>
            </div>
            <div class="stat">
                <div class="stat-value">5</div>
                <div class="stat-label">Genres</div>
            </div>
        </div>
        
        <div class="genre-pills">
            <div class="genre-pill all active" data-genre="all">All Genres</div>
            <div class="genre-pill electronic" data-genre="Electronic">Electronic</div>
            <div class="genre-pill rock" data-genre="Rock">Rock</div>
            <div class="genre-pill indie" data-genre="Indie">Indie</div>
            <div class="genre-pill metal" data-genre="Metal">Metal</div>
            <div class="genre-pill funk" data-genre="Funk">Funk</div>
        </div>
        
        <div class="filters">
            <div class="filter-group">
                <label>Search</label>
                <input type="text" id="searchInput" placeholder="Handle, positioning...">
            </div>
            <div class="filter-group">
                <label>Min Followers</label>
                <select id="followerFilter">
                    <option value="0">Any</option>
                    <option value="10000">10K+</option>
                    <option value="50000">50K+</option>
                    <option value="100000">100K+</option>
                    <option value="500000">500K+</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Sort By</label>
                <select id="sortBy">
                    <option value="followers">Followers (Highâ†’Low)</option>
                    <option value="followers-asc">Followers (Lowâ†’High)</option>
                    <option value="engagement">Engagement Rate</option>
                    <option value="handle">Handle (A-Z)</option>
                </select>
            </div>
            <div class="filter-group">
                <label>&nbsp;</label>
                <button class="export-btn" onclick="exportCSV()">ðŸ“¥ Export CSV</button>
            </div>
        </div>
        
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Genre</th>
                        <th>Handle</th>
                        <th>Followers</th>
                        <th>Engagement</th>
                        <th>Avg Views</th>
                        <th>Positioning</th>
                        <th>Unplugs Fit</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>
        <div class="no-results" id="noResults" style="display:none;">No profiles match your filters</div>
    </div>
    
    <script>
        let allData = [];
        let filteredData = [];
        
        async function loadData() {
            try {
                const response = await fetch('data/unplugs-superfan-influencers.csv');
                const text = await response.text();
                const lines = text.trim().split('\n');
                const headers = parseCSVLine(lines[0]);
                
                allData = lines.slice(1).map(line => {
                    const values = parseCSVLine(line);
                    const obj = {};
                    headers.forEach((h, i) => obj[h] = values[i] || '');
                    obj.followersNum = parseFollowers(obj.followers);
                    obj.engagementNum = parseEngagement(obj.engagement_rate);
                    return obj;
                });
                
                document.getElementById('totalCount').textContent = allData.length;
                filterAndRender();
            } catch (e) {
                console.error('Error loading data:', e);
            }
        }
        
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }
        
        function parseFollowers(str) {
            if (!str) return 0;
            str = str.replace(/,/g, '');
            const match = str.match(/([\d.]+)\s*(K|M)?/i);
            if (!match) return parseInt(str) || 0;
            let num = parseFloat(match[1]);
            if (match[2]?.toUpperCase() === 'K') num *= 1000;
            if (match[2]?.toUpperCase() === 'M') num *= 1000000;
            return Math.round(num);
        }
        
        function parseEngagement(str) {
            if (!str) return 0;
            const match = str.match(/([\d.]+)/);
            return match ? parseFloat(match[1]) : 0;
        }
        
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
            return num.toString();
        }
        
        function filterAndRender() {
            const genre = document.querySelector('.genre-pill.active').dataset.genre;
            const search = document.getElementById('searchInput').value.toLowerCase();
            const minFollowers = parseInt(document.getElementById('followerFilter').value);
            const sortBy = document.getElementById('sortBy').value;
            
            filteredData = allData.filter(row => {
                if (genre !== 'all' && row.genre !== genre) return false;
                if (row.followersNum < minFollowers) return false;
                if (search && !row.handle.toLowerCase().includes(search) && 
                    !row.positioning.toLowerCase().includes(search) &&
                    !row.unplugs_fit.toLowerCase().includes(search)) return false;
                return true;
            });
            
            // Sort
            filteredData.sort((a, b) => {
                if (sortBy === 'followers') return b.followersNum - a.followersNum;
                if (sortBy === 'followers-asc') return a.followersNum - b.followersNum;
                if (sortBy === 'engagement') return b.engagementNum - a.engagementNum;
                if (sortBy === 'handle') return a.handle.localeCompare(b.handle);
                return 0;
            });
            
            renderTable();
            updateStats();
        }
        
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const noResults = document.getElementById('noResults');
            
            if (filteredData.length === 0) {
                tbody.innerHTML = '';
                noResults.style.display = 'block';
                return;
            }
            noResults.style.display = 'none';
            
            tbody.innerHTML = filteredData.map(row => `
                <tr>
                    <td><span class="genre-badge ${row.genre.toLowerCase()}">${row.genre}</span></td>
                    <td class="handle-cell"><a href="${row.profile_url}" target="_blank">@${row.handle}</a></td>
                    <td class="followers">${row.followers}</td>
                    <td class="engagement">${row.engagement_rate}</td>
                    <td>${row.avg_views}</td>
                    <td class="positioning">${row.positioning}</td>
                    <td class="fit">${row.unplugs_fit}</td>
                </tr>
            `).join('');
        }
        
        function updateStats() {
            document.getElementById('filteredCount').textContent = filteredData.length;
            const totalReach = filteredData.reduce((sum, row) => sum + row.followersNum, 0);
            document.getElementById('totalReach').textContent = formatNumber(totalReach);
        }
        
        function exportCSV() {
            const headers = ['genre', 'handle', 'profile_url', 'followers', 'engagement_rate', 'avg_views', 'positioning', 'unplugs_fit'];
            const csvContent = [
                headers.join(','),
                ...filteredData.map(row => headers.map(h => `"${(row[h] || '').replace(/"/g, '""')}"`).join(','))
            ].join('\n');
            
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'unplugs-superfans-export.csv';
            a.click();
        }
        
        // Event listeners
        document.querySelectorAll('.genre-pill').forEach(pill => {
            pill.addEventListener('click', () => {
                document.querySelectorAll('.genre-pill').forEach(p => p.classList.remove('active'));
                pill.classList.add('active');
                filterAndRender();
            });
        });
        
        document.getElementById('searchInput').addEventListener('input', filterAndRender);
        document.getElementById('followerFilter').addEventListener('change', filterAndRender);
        document.getElementById('sortBy').addEventListener('change', filterAndRender);
        
        loadData();
    </script>
</body>
</html>
